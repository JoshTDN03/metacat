<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<bean id="rdfXmlSubprocessor" class="edu.ucsb.nceas.metacat.index.annotation.RdfXmlSubprocessor">
		<property name="matchDocument"
			value="/d100:systemMetadata/formatId[text()='http://www.w3.org/TR/rdf-syntax-grammar']" />
		<property name="fieldList">
			<list>
				<ref bean="annotation.measurement" />
			</list>
		</property>	
	</bean>
	
	<bean id="annotation.measurement" class="edu.ucsb.nceas.metacat.index.annotation.SparqlField">
		<constructor-arg name="name" value="standard_sm" />
		<constructor-arg name="query">
			<value>
				<![CDATA[
				PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
				PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> 
				PREFIX owl: <http://www.w3.org/2002/07/owl#> 
				PREFIX oboe-core: <http://ecoinformatics.org/oboe/oboe.1.0/oboe-core.owl#> 
				PREFIX oa: <http://www.w3.org/ns/oa#>
				PREFIX dcterms: <http://purl.org/dc/terms/>
				PREFIX foaf: <http://xmlns.com/foaf/0.1/>

				SELECT ?standard_sm ?pid
				FROM <$GRAPH_NAME>
				WHERE { 
						
						?measurement rdf:type oboe-core:Measurement .
						?measurement rdf:type ?restriction .
						?restriction owl:onProperty oboe-core:usesStandard .
						?restriction owl:allValuesFrom ?standard .
						?standard rdfs:subClassOf+ ?standard_sm .
						?standard_sm rdfs:subClassOf oboe-core:Standard .
						
						?annotation oa:hasBody ?measurement .												
						?annotation oa:hasTarget ?target .
						?target oa:hasSource ?metadata .
						?metadata dcterms:identifier ?pid . 
						
				 	} 
				 ]]>
			</value>
		</constructor-arg>
		<!--property name="multivalue" value="false" /-->
	</bean>

</beans>